---
title: Webkit系列：第一回
category: Webkit系列
date: 2023-07-28 01:13:25
tags:
---
本系列的目标：**尝试深入理解当前浏览器（谷歌）的大体逻辑。内容严重参考《Webkit技术内幕》**

现代浏览器的渲染逻辑，就是下图的流程。
![layoput](img/layout.webp)

一个经典的面试题：从输入url到最终页面的呈现，这其中都经历了些啥？
坦白讲这个问题很有深度也很有价值，因为完全可以根据你的描述，看出你对现代浏览器执行机制的整体把握和理解。

总体可分为网页加载过程（DOMContent事件）和渲染过程（onload事件）。
具体：
1. 浏览器根据输入的内容做识别，如果输入的是网址，调用DNS解析目标IP，建立连接。如果是关键词，调用搜索引擎去搜索。
2. 依赖网络模块，三次握手建立连接后获取到各种资源，包括js、html、css等等。
3. html文件被交给HTML解释器转变成一系列词语，然后构建节点生成DOM树（树形结构的对象），css文件被交给css解释器生成样式树。在这过程中，碰到js代码，终端dom树的构建，权限会给到jscore引擎解释处理，谷歌浏览器中的就是大名鼎鼎的v8。此处涉及到进程切换。执行完js后权限交回给html解释器。当然碰到的js代码也会根据如async或者defer同步异步操作。
4. csss解释器完成工作后，会在dom树上附加解释后的样式信息，生成RenderObject树，然后转变成RenderLayer树。此时已得到绘制页面所需的绘图上下文信息，也就是图中的**layout阶段**。
5. 最后的就是**Paint**和**Composite**两个阶段生成最终的页面。