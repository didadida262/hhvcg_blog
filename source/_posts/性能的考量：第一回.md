---
title: 性能的考量：第一回
category: 性能的考量
date: 2023-08-03 17:16:31
tags:
---

**本文旨在梳理目下通用的性能优化方法**

性能优化没有一个统一的指标，但目的是明确的，就是要让站点应用的加载速度够快，如此用户体验才能高（暂且不管页面做的烂不烂）。三个大的角度：带宽、延时和渲染耗时。

那么由于现代光纤通信的大规模普及，带宽的影响因素，已经小到可以忽略不计的地步。剩下的就是延迟耗时和渲染。

- **延迟耗时层面**。
《计算机网络》的第六版中，对于延迟给出了明确的定义，从c端发出消息到s端收到消息的时间消耗，具体包括：排队延迟 --（缓冲）-> 处理延迟--（路由）->传输延迟--->传播延迟。
1. 通过缓存资源，屏蔽无意义的重复请求。具体操作开启cache-control。
2. 尽可能的减少请求。能合并的，尽可能地合并。
3. 后端gzip压缩。
4. 前端懒加载资源
5. CDN：同样大小的资源，距离用户越近，耗时理论上越小（网速差距不大）。
6. 长连接。规避无意义的建立链路耗时。
...
...
上述的这些方案，基本可以用《高性能浏览器网络》的结论做总结：
**优化的三大准则：**
1. 再快也快不过什么也不用发送，能少发就少发。 （合并请求）
2. 我们不能让数据传输得更快，但可以让它们传输的距离更短。 （CDN）
3. 重用 TCP 连接是提升性能的关键。（长连接）

- **渲染层面**
1. DNS预解析甚至tcp链路预链接。
假设页面中有几个超链接。用户没有点击的时候我就已经预解析了域名ip甚至链路都连接好了，这样，当用户点的时候，只剩下发送资源请求的耗时。但该方法用的不是很多。
2. script标签defer或者async。由于在解析html时若碰到js代码就会牵扯到进程切换带来的开销且会阻塞html的解析，因此通过这俩属性规避之。
<img src="/img/defer.png" alt="图片描述" width="500">

3. 减少重排重绘带来的不必要的开销。

当然从后端的角度考虑，处理请求发出响应的耗时也需要考虑。所以优化方法： **让老板砸钱，换更高端的设备，才是王炸之策**
毕。