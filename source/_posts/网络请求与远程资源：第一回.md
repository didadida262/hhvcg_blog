---
title: 网络请求与远程资源：第一回
date: 2023-08-28 23:05:14
category: 大前端气宗专栏
---

### 本系列文章主要用于介绍获取网络资源的三种方式：Ajax、Fetch和WebSocket

#### 1. Ajax（Asynchronous Javascript + XML），异步js和xml
曾经的页面及其简单。页面类似于公告栏，文字加图片。打开地址拿到资源展示即可。什么？你说你还想要点击交互？**刷新页面吧**。而作为上古技术的ajax的出现，第一次实现了无需刷新也能重新发送请求获取数据。
提到ajax就一定会涉及到XHR（XMLHttpRequest）。下面时经典的ajax请求写法
```javascript
const xhr = new XMLHttpRequest()

xhr.onreadystateChange = function() {
    // 状态码4代表响应完成
    if (xhr.readyState === 4) {
        if ((xhr.status >= 200 && xhr.status < 300) || xhr.status === 304) {
            // 响应有效
            console.log(xhr.responseText)
        } else {
            alert('fail>>>>')
        }
    }
}

xhr.open('get', 'http://www.baidu.com', '是否异步布尔值')
xhr.send(null)
```
这里提一下get和post请求。除了有无请求body外，有一个性能方面的区别。发送相同数量的数据，get请求几乎比post请求快两倍，因为post是两请求。

#### 2. XHR是出了名的难用，于是，支持期约（promise）的fetch应运而生。

#### 跨域资源共享
- 图片探测。利用img标签不受跨域的限制。缺点在于纯纯的单向，无法接收数据
- JSONP。利用script标签的不受限制的特性。标准代码如下：
```javascript
<script src="http://www.xxx.com/json/?callback=handlejsonp"></script>
const handlejsonp = function(response) {
    console.log('response>>>', response)
}
// 用习惯了axios，看到这玩意怪怪的
```